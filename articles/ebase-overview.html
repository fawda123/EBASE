<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EBASE overview • EBASE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="EBASE overview">
<meta property="og:description" content="EBASE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EBASE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ebase-overview.html">EBASE overview</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fawda123/EBASE/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ebase-overview_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>EBASE overview</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fawda123/EBASE/blob/HEAD/vignettes/ebase-overview.Rmd" class="external-link"><code>vignettes/ebase-overview.Rmd</code></a></small>
      <div class="hidden name"><code>ebase-overview.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>This vignette provides an overview of the theory and use of the EBASE R package or Estuarine BAyesian Single-station Estimation method for ecosystem metabolism. Use the following to install the package from R-Universe. The <a href="https://mcmc-jags.sourceforge.io/" class="external-link">JAGS</a> software must also be installed to use this package. Follow the instructions in the link to download and install the version appropriate for your operating system.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Enable the r-universe repo</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    fawda123 <span class="op">=</span> <span class="st">'https://fawda123.r-universe.dev'</span>,
    CRAN <span class="op">=</span> <span class="st">'https://cloud.r-project.org'</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Install</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'EBASE'</span><span class="op">)</span></code></pre></div>
<p>Load the package after installation to use the functions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fawda123/EBASE" class="external-link">EBASE</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>An example file called <code><a href="../reference/exdat.html">exdat()</a></code> is included with the package that demonstrates the required time series format to use the package. It includes nearly a year of continuously monitored water quality and meteorological data at the Appalachicola National Estuarine Research Reserve. The required data include a date and time vector, dissolve oxygen (mg/L), water temperature (C), salinity (psu), PAR (W/m2/s), and wind speed (m/s). The time step should be consistent throughout the dataset and is indicated as an argument to the <code><a href="../reference/ebase.html">ebase()</a></code> function (see below). The <code><a href="../reference/exdat.html">exdat()</a></code> dataset can be viewed at any time after the package is loaded and is used in the examples in the help files:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">exdat</span><span class="op">)</span>
<span class="co">#&gt;         DateTimeStamp   DO_obs Temp  Sal PAR WSpd</span>
<span class="co">#&gt; 1 2012-02-23 00:00:00 8.217998 16.4 23.0   0  3.6</span>
<span class="co">#&gt; 2 2012-02-23 00:15:00 8.210692 16.4 22.8   0  3.5</span>
<span class="co">#&gt; 3 2012-02-23 00:30:00 8.203855 16.4 22.7   0  3.6</span>
<span class="co">#&gt; 4 2012-02-23 00:45:00 8.197538 16.4 22.9   0  4.2</span>
<span class="co">#&gt; 5 2012-02-23 01:00:00 8.191786 16.4 22.7   0  3.6</span>
<span class="co">#&gt; 6 2012-02-23 01:15:00 8.186632 16.4 23.4   0  4.1</span></code></pre></div>
<p>The core function to estimate metabolism is <code><a href="../reference/ebase.html">ebase()</a></code>. The metabolic estimates are based on a mass balance equation in Grace et al. 2015 <span class="citation">(Grace et al. 2015)</span> with the gas exchange estimate from Wanninkhof 2014 <span class="citation">(Wanninkhof 2014)</span>. It is similar to that provided by the BASEmetab R package at <a href="https://github.com/dgiling/BASEmetab" class="external-link uri">https://github.com/dgiling/BASEmetab</a>, with modifications to estimate different parameters. The equation optimized in the JAGS model is:</p>

<p>Gross production is provided by <em>aPAR</em>, respiration is provided by <em>r</em>, and gas exchange is provided by the remainder. The likelihood of the parameters <em>a</em>, <em>r</em>, and <em>b</em> given the observed data are estimated from the JAGS model using prior distributions shown in the model file. At each time step, the change in oxygen concentration between time steps is calculated from the equation using model inputs and parameter guesses, and then a finite difference approximation is used to estimate modeled oxygen concentration. The estimated concentration is also returned for comparison to observed as one measure of model performance.</p>
<p>The following shows how to use the <code><a href="../reference/ebase.html">ebase()</a></code> function with a subset of four days from the <code><a href="../reference/exdat.html">exdat()</a></code> example dataset. The subset is first created:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span>

<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">exdat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">exdat</span><span class="op">$</span><span class="va">DateTimeStamp</span><span class="op">)</span> <span class="op">==</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">exdat</span><span class="op">$</span><span class="va">DateTimeStamp</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="co">#&gt;         DateTimeStamp   DO_obs Temp  Sal PAR WSpd</span>
<span class="co">#&gt; 1 2012-06-01 00:00:00 5.185803 29.5 23.0   0  2.0</span>
<span class="co">#&gt; 2 2012-06-01 00:15:00 5.174494 29.5 23.3   0  2.3</span>
<span class="co">#&gt; 3 2012-06-01 00:30:00 5.163948 29.5 23.4   0  2.1</span>
<span class="co">#&gt; 4 2012-06-01 00:45:00 5.154150 29.5 23.3   0  2.0</span>
<span class="co">#&gt; 5 2012-06-01 01:00:00 5.145070 29.5 23.1   0  1.7</span>
<span class="co">#&gt; 6 2012-06-01 01:15:00 5.136675 29.5 24.0   0  1.8</span></code></pre></div>
<p>Then, the <code><a href="../reference/ebase.html">ebase()</a></code> function is used to estimate the metabolic rates with the appropriate function arguments. The timestep <code>interval</code> is 900 seconds (15 minutes), the water column depth (<code>H</code>) is 1.85 meters, a log file of the model iterations for each day is created by setting <code>progress = TRUE</code>, and only two Markov chains are used (<code>n.chains</code> = 2). In practice, a larger number for <code>n.chains</code> should be used to verify model convergence.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase.html">ebase</a></span><span class="op">(</span><span class="va">dat</span>, interval <span class="op">=</span> <span class="fl">900</span>, H <span class="op">=</span> <span class="fl">1.85</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, n.chains <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
<span class="co">#&gt;         Date   DO_obs   DO_mod       DateTimeStamp       dDO           a</span>
<span class="co">#&gt; 2 2012-06-01 161.7030 161.9897 2012-06-01 00:15:00 -6.397271 0.007665909</span>
<span class="co">#&gt; 3 2012-06-01 161.3734 161.9472 2012-06-01 00:30:00 -4.081800 0.007665909</span>
<span class="co">#&gt; 4 2012-06-01 161.0672 161.8877 2012-06-01 00:45:00 -5.707063 0.007665909</span>
<span class="co">#&gt; 5 2012-06-01 160.7834 161.8207 2012-06-01 01:00:00 -6.428347 0.007665909</span>
<span class="co">#&gt; 6 2012-06-01 160.5211 161.7329 2012-06-01 01:15:00 -8.430377 0.007665909</span>
<span class="co">#&gt; 7 2012-06-01 160.2787 161.6505 2012-06-01 01:30:00 -7.911351 0.007665909</span>
<span class="co">#&gt;           b Pg_vol   Rt_vol         D</span>
<span class="co">#&gt; 2 0.2264261      0 13.76921 -7.371940</span>
<span class="co">#&gt; 3 0.2264261      0 13.76921 -9.687412</span>
<span class="co">#&gt; 4 0.2264261      0 13.76921 -8.062149</span>
<span class="co">#&gt; 5 0.2264261      0 13.76921 -7.340864</span>
<span class="co">#&gt; 6 0.2264261      0 13.76921 -5.338834</span>
<span class="co">#&gt; 7 0.2264261      0 13.76921 -5.857861</span></code></pre></div>
<div id="refs" class="references">
<div id="ref-Grace15">
<p>Grace, Michael R, Darren P Giling, Sally Hladyz, Valerie Caron, Ross M Thompson, and Ralph Mac Nally. 2015. “Fast Processing of Diel Oxygen Curves: Estimating Stream Metabolism with Base (Ba Yesian S Ingle-Station E Stimation).” <em>Limnology and Oceanography: Methods</em> 13 (3): 103–14. <a href="https://doi.org/10.1002/lom3.10011" class="external-link">https://doi.org/10.1002/lom3.10011</a>.</p>
</div>
<div id="ref-Wanninkhof14">
<p>Wanninkhof, Rik. 2014. “Relationship Between Wind Speed and Gas Exchange over the Ocean Revisited.” <em>Limnology and Oceanography: Methods</em> 12 (6): 351–62. <a href="https://doi.org/10.4319/lom.2014.12.351" class="external-link">https://doi.org/10.4319/lom.2014.12.351</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Marcus Beck, Maria Herrmann, Jill Arriola, Raymond Najjar, Wade McGillis.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
