<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EBASE">
<title>EBASE overview • EBASE</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EBASE overview">
<meta property="og:description" content="EBASE">
<meta property="og:image" content="https://fawda123.github.io/EBASE/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EBASE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9004</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ebase-overview.html">EBASE overview</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/fawda123/EBASE/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="ebase-overview_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>EBASE overview</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fawda123/EBASE/blob/HEAD/vignettes/ebase-overview.Rmd" class="external-link"><code>vignettes/ebase-overview.Rmd</code></a></small>
      <div class="d-none name"><code>ebase-overview.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>This vignette provides an overview of the theory and use of the the Estuarine BAyesian Single-station Estimation (EBASE) R package for ecosystem metabolism. Use the following to install the package from R-Universe. The <a href="https://mcmc-jags.sourceforge.io/" class="external-link">JAGS</a> software must also be installed to use this package. Follow the instructions in the link to download and install the JAGS version appropriate for your operating system.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Enable the r-universe repo</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    fawda123 <span class="op">=</span> <span class="st">'https://fawda123.r-universe.dev'</span>,</span>
<span>    CRAN <span class="op">=</span> <span class="st">'https://cloud.r-project.org'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'EBASE'</span><span class="op">)</span></span></code></pre></div>
<p>Load the package after installation to use the functions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fawda123.github.io/EBASE">EBASE</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h3>
<p>An example file called <code><a href="../reference/exdat.html">exdat()</a></code> is included with the package that demonstrates the required time series format to use the functions. It includes nearly a year of continuously monitored water quality and meteorological data at the Apalachicola National Estuarine Research Reserve. The required data include a date and time vector (<code>DateTimeStamp</code>), dissolved oxygen (mg/L, <code>DO_obs</code>) , water temperature (C, <code>Temp</code>), salinity (psu, <code>Sal</code>), PAR (W/m2/s, <code>PAR</code>), and wind speed (m/s, <code>WSpd</code>). The time step should be consistent throughout the dataset and is indicated as an argument to the <code><a href="../reference/ebase.html">ebase()</a></code> function (see below). The <code><a href="../reference/exdat.html">exdat()</a></code> dataset can be viewed at any time after the package is loaded and is used in the examples in the help files:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">exdat</span><span class="op">)</span></span>
<span><span class="co">#&gt;         DateTimeStamp DO_obs Temp  Sal PAR WSpd</span></span>
<span><span class="co">#&gt; 1 2012-02-23 00:00:00    8.8 16.4 23.0   0  3.6</span></span>
<span><span class="co">#&gt; 2 2012-02-23 00:15:00    8.8 16.4 22.8   0  3.5</span></span>
<span><span class="co">#&gt; 3 2012-02-23 00:30:00    8.8 16.4 22.7   0  3.6</span></span>
<span><span class="co">#&gt; 4 2012-02-23 00:45:00    8.8 16.4 22.9   0  4.2</span></span>
<span><span class="co">#&gt; 5 2012-02-23 01:00:00    8.7 16.4 22.7   0  3.6</span></span>
<span><span class="co">#&gt; 6 2012-02-23 01:15:00    8.5 16.4 23.4   0  4.1</span></span></code></pre></div>
<p>The core function to estimate metabolism is <code><a href="../reference/ebase.html">ebase()</a></code>. The metabolic estimates are based on a mass balance equation in <span class="citation">Grace et al. (2015)</span> with the gas exchange estimate from <span class="citation">Wanninkhof (2014)</span>. It is similar to that provided by the BASEmetab R package at <a href="https://github.com/dgiling/BASEmetab" class="external-link uri">https://github.com/dgiling/BASEmetab</a>, with modifications to estimate different parameters optimized by the JAGS model:</p>
<p><span class="math display">\[
\frac{\delta{C_d}}{\delta{t}} = [\,aPAR]\, - [\,r]\, - \frac{1}{H}\left[-bU_{10}^2\left(\frac{s_c}{600} \right)^{-0.5} \left(C_{Sat} - C_d \right )\right]
\]</span></p>
<p>The metabolic estimates are defined by the change in dissolved oxygen over the time step <span class="math inline">\(\frac{\delta{C_d}}{\delta{t}}\)</span>, where gross production is provided by <span class="math inline">\(aPAR\)</span>, respiration is provided by <span class="math inline">\(r\)</span>, and gas exchange is provided by the remainder. Required inputs for the equation are dissolved oxygen concentration as <span class="math inline">\(C_d\)</span>, solar radiation as <span class="math inline">\(PAR\)</span>, water column depth as <span class="math inline">\(H\)</span> (meters), and wind speed as <span class="math inline">\(U\)</span>. Other inputs for the schmidt number <span class="math inline">\(s_c\)</span> and dissolved oxygen at saturation <span class="math inline">\(C_{Sat}\)</span> are calculated from the observed data by the package. The remaining three parameters <span class="math inline">\(a\)</span>, <span class="math inline">\(r\)</span>, and <span class="math inline">\(b\)</span> are estimated by likelihood given the observed data with the JAGS model using prior distributions shown in the model file. At each time step, the change in oxygen concentration between time steps is calculated from the equation using model inputs and parameter guesses, and then a finite difference approximation is used to estimate modeled oxygen concentration. The estimated concentration is also returned, which can be compared to observed as one measure of model performance.</p>
<p>The following shows how to use the <code><a href="../reference/ebase.html">ebase()</a></code> function with a subset of four days from the <code><a href="../reference/exdat.html">exdat()</a></code> example dataset. Running the model on the entire year will take a few minutes, so a subset is used:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># subset four days in June</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">exdat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">exdat</span><span class="op">$</span><span class="va">DateTimeStamp</span><span class="op">)</span> <span class="op">==</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">exdat</span><span class="op">$</span><span class="va">DateTimeStamp</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;         DateTimeStamp DO_obs Temp  Sal PAR WSpd</span></span>
<span><span class="co">#&gt; 1 2012-06-01 00:00:00    4.5 29.5 23.0   0  2.0</span></span>
<span><span class="co">#&gt; 2 2012-06-01 00:15:00    5.1 29.5 23.3   0  2.3</span></span>
<span><span class="co">#&gt; 3 2012-06-01 00:30:00    4.8 29.5 23.4   0  2.1</span></span>
<span><span class="co">#&gt; 4 2012-06-01 00:45:00    4.8 29.5 23.3   0  2.0</span></span>
<span><span class="co">#&gt; 5 2012-06-01 01:00:00    4.8 29.5 23.1   0  1.7</span></span>
<span><span class="co">#&gt; 6 2012-06-01 01:15:00    5.0 29.5 24.0   0  1.8</span></span></code></pre></div>
<p>Then, the <code><a href="../reference/ebase.html">ebase()</a></code> function is used to estimate the metabolic rates with the appropriate function arguments. The timestep <code>interval</code> is 900 seconds (15 minutes), the water column depth <code>H</code> is 1.85 meters, a log file of the model iterations for each day is created by setting <code>progress = TRUE</code>, and only two Markov chains are used with <code>n.chains = 2</code>. In practice, a larger number for <code>n.chains</code> should be used to verify model convergence.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase.html">ebase</a></span><span class="op">(</span><span class="va">dat</span>, interval <span class="op">=</span> <span class="fl">900</span>, H <span class="op">=</span> <span class="fl">1.85</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, n.chains <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Date grp  DO_obs   DO_mod DO_modlo DO_modhi       DateTimeStamp</span></span>
<span><span class="co">#&gt; 2 2012-06-01   1 159.375 140.5837 140.4878 140.6835 2012-06-01 00:15:00</span></span>
<span><span class="co">#&gt; 3 2012-06-01   1 150.000 140.5813 140.3893 140.7805 2012-06-01 00:30:00</span></span>
<span><span class="co">#&gt; 4 2012-06-01   1 150.000 140.5517 140.2640 140.8508 2012-06-01 00:45:00</span></span>
<span><span class="co">#&gt; 5 2012-06-01   1 150.000 140.5098 140.1269 140.9090 2012-06-01 01:00:00</span></span>
<span><span class="co">#&gt; 6 2012-06-01   1 156.250 140.4341 139.9568 140.9340 2012-06-01 01:15:00</span></span>
<span><span class="co">#&gt; 7 2012-06-01   1 168.750 140.3677 139.7960 140.9673 2012-06-01 01:30:00</span></span>
<span><span class="co">#&gt;          dDO converge       rsq          a        alo        ahi         b</span></span>
<span><span class="co">#&gt; 2 -3.9723113     Fine 0.3375187 0.06861544 0.04993472 0.08852616 0.2511753</span></span>
<span><span class="co">#&gt; 3 -0.2237797     Fine 0.3375187 0.06861544 0.04993472 0.08852616 0.2511753</span></span>
<span><span class="co">#&gt; 4 -2.8440348     Fine 0.3375187 0.06861544 0.04993472 0.08852616 0.2511753</span></span>
<span><span class="co">#&gt; 5 -4.0249243     Fine 0.3375187 0.06861544 0.04993472 0.08852616 0.2511753</span></span>
<span><span class="co">#&gt; 6 -7.2653151     Fine 0.3375187 0.06861544 0.04993472 0.08852616 0.2511753</span></span>
<span><span class="co">#&gt; 7 -6.3750141     Fine 0.3375187 0.06861544 0.04993472 0.08852616 0.2511753</span></span>
<span><span class="co">#&gt;         blo       bhi Pg_vol Pg_vollo Pg_volhi   Rt_vol Rt_vollo Rt_volhi</span></span>
<span><span class="co">#&gt; 2 0.2415865 0.2609527      0        0        0 15.83389   6.1542 25.06089</span></span>
<span><span class="co">#&gt; 3 0.2415865 0.2609527      0        0        0 15.83389   6.1542 25.06089</span></span>
<span><span class="co">#&gt; 4 0.2415865 0.2609527      0        0        0 15.83389   6.1542 25.06089</span></span>
<span><span class="co">#&gt; 5 0.2415865 0.2609527      0        0        0 15.83389   6.1542 25.06089</span></span>
<span><span class="co">#&gt; 6 0.2415865 0.2609527      0        0        0 15.83389   6.1542 25.06089</span></span>
<span><span class="co">#&gt; 7 0.2415865 0.2609527      0        0        0 15.83389   6.1542 25.06089</span></span>
<span><span class="co">#&gt;           D       Dlo       Dhi</span></span>
<span><span class="co">#&gt; 2 11.861583 11.408796 12.323098</span></span>
<span><span class="co">#&gt; 3 15.610114 15.009862 16.210384</span></span>
<span><span class="co">#&gt; 4 12.989859 12.492052 13.484294</span></span>
<span><span class="co">#&gt; 5 11.808970 11.342863 12.265032</span></span>
<span><span class="co">#&gt; 6  8.568579  8.229131  8.906312</span></span>
<span><span class="co">#&gt; 7  9.458880  9.077524  9.835380</span></span></code></pre></div>
<p>The results are returned as a data frame with instantaneous metabolic estimates for volumetric gross production (O2 mmol/m3/d, <code>Pg_vol</code> or <span class="math inline">\(aPAR\)</span> from above), respiration (O2 mmol/m3/d, <code>Rt_vol</code> or <span class="math inline">\(r\)</span> from above), and gas exchange (O2 mmol/m3/d, <code>D</code> or the remainder of the equation from above). Additional parameters estimated by the model that are returned include <code>a</code> and <code>b</code> as shown in the above equation. The <code>a</code> parameter is a constant that represents the primary production per quantum of light with units of (mmol/m3/d)/(W/m2) and is used to estimate gross production <span class="citation">(Grace et al. 2015)</span>. The <code>b</code> parameter is a constant used to estimate gas exchange in (cm/hr)/(m2/s2) (provided as 0.251 in eqn. 4 in <span class="citation">Wanninkhof (2014)</span>).</p>
<p>A plot of the results can be made with <code><a href="../reference/ebase_plot.html">ebase_plot()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ebase_plot.html">ebase_plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-5-1.png" width="864" style="display: block; margin: auto;"></p>
<p>The daily averages can also be plotted by using <code>instantaneous = FALSE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ebase_plot.html">ebase_plot</a></span><span class="op">(</span><span class="va">res</span>, instantaneous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-6-1.png" width="864" style="display: block; margin: auto;"></p>
<p>Execution time of the model can also be reduced by using multiple processors. This is done using <a href="https://cran.r-project.org/web/packages/doParallel/index.html" class="external-link">doParrallel</a> package and registering a parallel backend as below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># setup parallel backend</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/doparallel" class="external-link">doParallel</a></span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase.html">ebase</a></span><span class="op">(</span><span class="va">dat</span>, interval <span class="op">=</span> <span class="fl">900</span>, H <span class="op">=</span> <span class="fl">1.85</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, n.chains <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<p>Model fit can be assessed using the <code>converge</code> and <code>rsq</code> columns from the returned results. The values in these columns apply to each group in the <code>grp</code> column as specified with the <code>ndays</code> argument. The <code>converge</code> column indicates <code>"Check convergence"</code> or <code>"Fine"</code> if the JAGS estimate converged at that iteration (repeated across rows for the group). The <code>n.chains</code> argument can be increased if convergence is not achieved. Similarly, the <code>rsq</code> column shows the r-squared values of the linear fit between the modeled and observed dissolved oxygen (repeated across rows for the group).</p>
<p>The model fit can also be assessed by comparing the observed and modeled values for dissolved oxygen with the <code><a href="../reference/fit_plot.html">fit_plot()</a></code> function. Estimated values are shown as line and observed values are shown as points.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fit_plot.html">fit_plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-8-1.png" width="864" style="display: block; margin: auto;"></p>
<p>The comparison can also be separated by group with <code>bygroup = TRUE</code> based on the value for the <code>ndays</code> argument passed to <code><a href="../reference/ebase.html">ebase()</a></code>. The r-squared value of the fit between modeled and observed dissolved oxygen is also shown in the facet label for the group.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fit_plot.html">fit_plot</a></span><span class="op">(</span><span class="va">res</span>, bygroup <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>A scatterplot showing modeled versus observed dissolved oxygen can also be returned by setting <code>scatter = TRUE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fit_plot.html">fit_plot</a></span><span class="op">(</span><span class="va">res</span>, bygroup <span class="op">=</span> <span class="cn">TRUE</span>, scatter <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The prior distributions for the <span class="math inline">\(a\)</span>, <span class="math inline">\(r\)</span>, and <span class="math inline">\(b\)</span> parameters are defined in the model file included with the package as normal Gaussian distributions with mean and standard deviations provided by the <code>aprior</code>, <code>rprior</code>, and <code>bprior</code> arguments in <code><a href="../reference/ebase.html">ebase()</a></code>. The location of the model file can be viewed as follows.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'ebase_model.txt'</span>, package <span class="op">=</span> <span class="st">'EBASE'</span><span class="op">)</span></span></code></pre></div>
<p>The default values for the priors were chosen based on the ability of EBASE to reproduce known parameters from a forward metabolism model. An additional constraint is that all the prior distributions are truncated to be positive values as required by the core metabolism equation above. The upper limit for <span class="math inline">\(b\)</span> is also set as 1.5 * 0.251, or 50% more than the default mean (Wanninkhof 2014 states that <span class="math inline">\(b\)</span> should not vary by more than +/- 20%). Units for each parameter are (mmol/m3/d)/(W/m2) for <span class="math inline">\(a\)</span>, mmol/m3/d for <span class="math inline">\(r\)</span>, and (cm/hr)/(m2/s2) for <span class="math inline">\(b\)</span>.</p>
<p>The prior distributions can be viewed with the <code><a href="../reference/prior_plot.html">prior_plot()</a></code> function. No changes are needed to the default arguments for this function if the default arguments are used for <code><a href="../reference/ebase.html">ebase()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prior_plot.html">prior_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-12-1.png" width="864" style="display: block; margin: auto;"></p>
<p>95% credible intervals for <code>a</code>, <code>Rt_vol</code>, and <code>b</code> are also returned with the output from <code><a href="../reference/ebase.html">ebase()</a></code> in the corresponding columns <code>alo</code>, <code>ahi</code>, <code>blo</code>, <code>bhi</code>, <code>Rt_vollo</code>, and <code>Rt_volhi</code>, for the 2.5th and 97.5th percentile estimates for each parameter, respectively. These values indicate the interval within which there is a 95% probability that the true parameter is in this range and is a representation of the posterior distributions for each parameter. Note that all values for these parameters are repeated across rows, although only one estimate for each is returned based on the number of days defined by <code>ndays</code>.</p>
<p>The credible intervals can be plotted with the <code><a href="../reference/credible_plot.html">credible_plot()</a></code> function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/credible_plot.html">credible_plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The credible intervals can also be retrieved as a data frame using <code><a href="../reference/credible_prep.html">credible_prep()</a></code>. This function is provided as a convenience to parse the results from <code><a href="../reference/ebase.html">ebase()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/credible_prep.html">credible_prep</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   grp [4]</span></span></span>
<span><span class="co">#&gt;    Date         grp var       mean       lo      hi</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2012-06-01     1 a       0.068<span style="text-decoration: underline;">6</span>  0.049<span style="text-decoration: underline;">9</span>   0.088<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2012-06-01     1 Rt_vol 15.8     6.15    25.1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2012-06-01     1 b       0.251   0.242    0.261 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2012-06-02     2 a       0.020<span style="text-decoration: underline;">8</span>  0.004<span style="text-decoration: underline;">96</span>  0.036<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2012-06-02     2 Rt_vol 32.2    22.6     42.1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2012-06-02     2 b       0.251   0.241    0.261 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2012-06-03     3 a       0.041<span style="text-decoration: underline;">5</span>  0.027<span style="text-decoration: underline;">8</span>   0.056<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2012-06-03     3 Rt_vol 15.7     7.00    24.4   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2012-06-03     3 b       0.251   0.241    0.261 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2012-06-04     4 a       0.037<span style="text-decoration: underline;">4</span>  0.022<span style="text-decoration: underline;">2</span>   0.050<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 2012-06-04     4 Rt_vol 37.1    28.2     45.9   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 2012-06-04     4 b       0.250   0.240    0.259</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="changing-the-default-arguments">Changing the default arguments<a class="anchor" aria-label="anchor" href="#changing-the-default-arguments"></a>
</h3>
<div class="section level4">
<h4 id="equation-optimization-length">Equation optimization length<a class="anchor" aria-label="anchor" href="#equation-optimization-length"></a>
</h4>
<p>The <code>ndays</code> argument in <code><a href="../reference/ebase.html">ebase()</a></code> defines the number of days that are used for optimizing the above mass balance equation. By default, this is done each day, i.e., <code>ndays = 1</code> such that a loop is used that applies the model equation to observations within each day, evaluated iteratively from the first observation in a day to the last. Individual parameter estimates for <code>a</code>, <code>r</code>, and <code>b</code> are then returned for each day. However, more days can be used to estimate the unknown parameters, such that the loop can be evaluated for every <code>ndays</code> specified by the argument. The <code>ndays</code> argument will separate the input data into groups of consecutive days, where each group has a total number of days equal to <code>ndays</code>. The final block may not include the complete number of days specified by <code>ndays</code> if the number of unique dates in the input data includes a remainder when divided by <code>ndays</code>, e.g., if seven days are in the input data and <code>ndays = 5</code>, there will be two groups where the first has five days and the second has two days. The output data from <code>ebase</code> includes a column that specifies the grouping that was used based on <code>ndays</code>.</p>
<p>Here, the number of days used to optimize the equation is set to all days in the input data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase.html">ebase</a></span><span class="op">(</span><span class="va">dat</span>, interval <span class="op">=</span> <span class="fl">900</span>, H <span class="op">=</span> <span class="fl">1.85</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, n.chains <span class="op">=</span> <span class="fl">2</span>, ndays <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<p>And the resulting plot:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ebase_plot.html">ebase_plot</a></span><span class="op">(</span><span class="va">res</span>, instantaneous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-16-1.png" width="864" style="display: block; margin: auto;"></p>
<p>And the fit of observed and modeled dissolved oxygen (note the unbroken line for all days estimated together):</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fit_plot.html">fit_plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-17-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="missing-values">Missing values<a class="anchor" aria-label="anchor" href="#missing-values"></a>
</h4>
<p>Missing values in the input data can also be interpolated prior to estimating metabolism. This is the default behavior and it is the responsibility of the user to verify that these interpolated values are not wildly inaccurate. Missing values are linearly interpolated between non-missing values at the time step specified by the value in <code>interval</code>. This works well for small gaps, but can easily create inaccurate values at gaps larger than a few hours.</p>
<p>As an example, the <code>dat</code> object above is subset to 90% of its observations.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">222</span><span class="op">)</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">DateTimeStamp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span>
<span><span class="co">#&gt;         DateTimeStamp DO_obs Temp  Sal PAR WSpd</span></span>
<span><span class="co">#&gt; 1 2012-06-01 00:00:00    4.5 29.5 23.0   0  2.0</span></span>
<span><span class="co">#&gt; 2 2012-06-01 00:30:00    4.8 29.5 23.4   0  2.1</span></span>
<span><span class="co">#&gt; 3 2012-06-01 01:00:00    4.8 29.5 23.1   0  1.7</span></span>
<span><span class="co">#&gt; 4 2012-06-01 01:30:00    5.4 29.6 24.9   0  1.8</span></span>
<span><span class="co">#&gt; 5 2012-06-01 01:45:00    5.4 29.6 24.6   0  1.8</span></span>
<span><span class="co">#&gt; 6 2012-06-01 02:00:00    5.3 29.6 24.8   0  2.0</span></span></code></pre></div>
<p>The <code><a href="../reference/ebase_prep.html">ebase_prep()</a></code> function is used internally to <code>ebase</code> to prepare the data for the metabolism calculations. This function interpolates the missing data and returns a column <code>isinterp</code> that specifies <code>TRUE</code> or <code>FALSE</code> if a value is interpolated.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat2interp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase_prep.html">ebase_prep</a></span><span class="op">(</span><span class="va">dat2</span>, H <span class="op">=</span> <span class="fl">1.85</span>, interval <span class="op">=</span> <span class="fl">900</span>, interp <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat2interp</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Date       DateTimeStamp isinterp   DO_obs   DO_sat    H  Temp   Sal</span></span>
<span><span class="co">#&gt; 1 2012-06-01 2012-06-01 00:00:00    FALSE 140.6250 209.6311 1.85 29.50 23.00</span></span>
<span><span class="co">#&gt; 2 2012-06-01 2012-06-01 00:15:00     TRUE 145.3125 209.3998 1.85 29.50 23.20</span></span>
<span><span class="co">#&gt; 3 2012-06-01 2012-06-01 00:30:00    FALSE 150.0000 209.1687 1.85 29.50 23.40</span></span>
<span><span class="co">#&gt; 4 2012-06-01 2012-06-01 00:45:00     TRUE 150.0000 209.3420 1.85 29.50 23.25</span></span>
<span><span class="co">#&gt; 5 2012-06-01 2012-06-01 01:00:00    FALSE 150.0000 209.5154 1.85 29.50 23.10</span></span>
<span><span class="co">#&gt; 6 2012-06-01 2012-06-01 01:15:00     TRUE 159.3750 208.3056 1.85 29.55 24.00</span></span>
<span><span class="co">#&gt;   PAR WSpd       sc grp</span></span>
<span><span class="co">#&gt; 1   0 2.00 344.9793   1</span></span>
<span><span class="co">#&gt; 2   0 2.05 345.1966   1</span></span>
<span><span class="co">#&gt; 3   0 2.10 345.4140   1</span></span>
<span><span class="co">#&gt; 4   0 1.90 345.2510   1</span></span>
<span><span class="co">#&gt; 5   0 1.70 345.0879   1</span></span>
<span><span class="co">#&gt; 6   0 1.75 345.2247   1</span></span></code></pre></div>
<p>The interpolated values can be visually inspected using the <code><a href="../reference/interp_plot.html">interp_plot()</a></code> function.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/interp_plot.html">interp_plot</a></span><span class="op">(</span><span class="va">dat2</span>, H <span class="op">=</span> <span class="fl">1.85</span>, interval <span class="op">=</span> <span class="fl">900</span>, param <span class="op">=</span> <span class="st">'DO_sat'</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-20-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="changing-priors">Changing priors<a class="anchor" aria-label="anchor" href="#changing-priors"></a>
</h4>
<p>If the default values prior distributions are changed for <code><a href="../reference/ebase.html">ebase()</a></code>, the <code><a href="../reference/prior_plot.html">prior_plot()</a></code> function can be used to assess how changing characteristics of the prior distributions could influence the resulting parameter estimates and their posterior distributions (e.g., as shown with <code><a href="../reference/credible_plot.html">credible_plot()</a></code>).</p>
<p>Here, the prior distribution for the <span class="math inline">\(b\)</span> parameter is changed to have a mean of 0.4 and standard deviation of 1.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prior_plot.html">prior_plot</a></span><span class="op">(</span>bprior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-21-1.png" width="864" style="display: block; margin: auto;"></p>
<p>The same change to the prior distribution for the <span class="math inline">\(b\)</span> parameter is applied to <code><a href="../reference/ebase.html">ebase()</a></code></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase.html">ebase</a></span><span class="op">(</span><span class="va">dat</span>, interval <span class="op">=</span> <span class="fl">900</span>, H <span class="op">=</span> <span class="fl">1.85</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, n.chains <span class="op">=</span> <span class="fl">2</span>, bprior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ebase_plot.html">ebase_plot</a></span><span class="op">(</span><span class="va">res</span>, instantaneous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-22-1.png" width="864" style="display: block; margin: auto;"></p>
<p>The <code><a href="../reference/credible_plot.html">credible_plot()</a></code> function can be used to assess how changing the prior distributions has an influence on the posterior distributions of the parameters.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/credible_plot.html">credible_plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="ebase-overview_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-Grace15">
<p>Grace, Michael R, Darren P Giling, Sally Hladyz, Valerie Caron, Ross M Thompson, and Ralph Mac Nally. 2015. “Fast Processing of Diel Oxygen Curves: Estimating Stream Metabolism with Base (Ba Yesian S Ingle-Station E Stimation).” <em>Limnology and Oceanography: Methods</em> 13 (3): 103–14. <a href="https://doi.org/10.1002/lom3.10011" class="external-link">https://doi.org/10.1002/lom3.10011</a>.</p>
</div>
<div id="ref-Wanninkhof14">
<p>Wanninkhof, Rik. 2014. “Relationship Between Wind Speed and Gas Exchange over the Ocean Revisited.” <em>Limnology and Oceanography: Methods</em> 12 (6): 351–62. <a href="https://doi.org/10.4319/lom.2014.12.351" class="external-link">https://doi.org/10.4319/lom.2014.12.351</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Marcus Beck, Maria Herrmann, Jill Arriola, Raymond Najjar, Wade McGillis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
