<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EBASE">
<title>EBASE overview • EBASE</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EBASE overview">
<meta property="og:description" content="EBASE">
<meta property="og:image" content="https://fawda123.github.io/EBASE/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EBASE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9016</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/EBASE.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/fawda123/EBASE/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>EBASE overview</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fawda123/EBASE/blob/HEAD/vignettes/EBASE.Rmd" class="external-link"><code>vignettes/EBASE.Rmd</code></a></small>
      <div class="d-none name"><code>EBASE.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>This vignette provides an overview of the theory and use of the the
Estuarine BAyesian Single-station Estimation (EBASE) R package for
ecosystem metabolism. Use the following to install the package from
R-Universe. The <a href="https://mcmc-jags.sourceforge.io/" class="external-link">JAGS</a>
software must also be installed to use this package. Follow the
instructions in the link to download and install the JAGS version
appropriate for your operating system.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install EBASE in R:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'EBASE'</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'https://fawda123.r-universe.dev'</span>, <span class="st">'https://cloud.r-project.org'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Load the package after installation to use the functions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fawda123.github.io/EBASE">EBASE</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h3>
<p>An example file called <code><a href="../reference/exdat.html">exdat()</a></code> is included with the
package that demonstrates the required time series format to use the
functions. It includes nearly a year of continuously monitored water
quality and meteorological data at the Apalachicola National Estuarine
Research Reserve. The required data include a date and time vector
(<code>DateTimeStamp</code>), dissolved oxygen (mg/L,
<code>DO_obs</code>) , water temperature (C, <code>Temp</code>),
salinity (psu, <code>Sal</code>), PAR (W/m2, <code>PAR</code>), and wind
speed (m/s, <code>WSpd</code>). The time step should be consistent
throughout the dataset and is indicated as an argument to the
<code><a href="../reference/ebase.html">ebase()</a></code> function (see below). The <code><a href="../reference/exdat.html">exdat()</a></code>
dataset can be viewed at any time after the package is loaded and is
used in the examples in the help files:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">exdat</span><span class="op">)</span></span>
<span><span class="co">#&gt;         DateTimeStamp DO_obs Temp  Sal PAR WSpd</span></span>
<span><span class="co">#&gt; 1 2012-02-23 00:00:00    8.8 16.4 23.0   0  3.6</span></span>
<span><span class="co">#&gt; 2 2012-02-23 00:15:00    8.8 16.4 22.8   0  3.5</span></span>
<span><span class="co">#&gt; 3 2012-02-23 00:30:00    8.8 16.4 22.7   0  3.6</span></span>
<span><span class="co">#&gt; 4 2012-02-23 00:45:00    8.8 16.4 22.9   0  4.2</span></span>
<span><span class="co">#&gt; 5 2012-02-23 01:00:00    8.7 16.4 22.7   0  3.6</span></span>
<span><span class="co">#&gt; 6 2012-02-23 01:15:00    8.5 16.4 23.4   0  4.1</span></span></code></pre></div>
<p>The core function to estimate metabolism is <code><a href="../reference/ebase.html">ebase()</a></code>. The
metabolic estimates are based on a mass balance equation in <span class="citation">Grace et al. (2015)</span> with the gas exchange
estimate from <span class="citation">Wanninkhof (2014)</span>. It is
similar to that provided by the BASEmetab R package at <a href="https://github.com/dgiling/BASEmetab" class="external-link uri">https://github.com/dgiling/BASEmetab</a>, with modifications
to estimate different parameters optimized by the JAGS model:</p>
<p><span class="math display">\[
Z\frac{dC_d}{dt} = aPAR - R - bU_{10}^2\left(\frac{Sc}{600}
\right)^{-0.5} \left(C_{Sat} - C_d \right )
\]</span></p>
<p>More simply:</p>
<p><span class="math display">\[
Z\frac{dC_d}{dt} = P - R - D
\]</span></p>
<p>The metabolic estimates are defined by the change in dissolved oxygen
over the time step <span class="math inline">\(\frac{dC_d}{dt}\)</span>,
where gross production is provided by <span class="math inline">\(aPAR\)</span>, respiration is provided by <span class="math inline">\(R\)</span>, and gas exchange is provided by the
remainder. Required inputs for the equation are dissolved oxygen
concentration as <span class="math inline">\(C_d\)</span>, solar
radiation as <span class="math inline">\(PAR\)</span>, water column
depth as <span class="math inline">\(Z\)</span> (meters), and wind speed
as <span class="math inline">\(U\)</span>. Other inputs for the schmidt
number <span class="math inline">\(Sc\)</span> and dissolved oxygen at
saturation <span class="math inline">\(C_{Sat}\)</span> are calculated
from the observed data. The remaining three parameters <span class="math inline">\(a\)</span>, <span class="math inline">\(R\)</span>, and <span class="math inline">\(b\)</span> are estimated by likelihood given the
observed data with the JAGS model using prior distributions shown in the
model file. At each time step, the change in oxygen concentration
between time steps is calculated from the equation using model inputs
and parameter guesses, and then a finite difference approximation is
used to estimate modeled oxygen concentration. The first modeled value
starts at the mean oxygen concentration for all measurements in the
optimization period. The estimated concentration is also returned at
each time step, which can be compared to observed as one measure of
model performance.</p>
<p>The following shows how to use the <code><a href="../reference/ebase.html">ebase()</a></code> function with
a subset of four days from the <code><a href="../reference/exdat.html">exdat()</a></code> example dataset.
Running the model on the entire year will take a few minutes, so a
subset is used:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># subset four days in June</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">exdat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">exdat</span><span class="op">$</span><span class="va">DateTimeStamp</span><span class="op">)</span> <span class="op">==</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">exdat</span><span class="op">$</span><span class="va">DateTimeStamp</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;         DateTimeStamp DO_obs Temp  Sal PAR WSpd</span></span>
<span><span class="co">#&gt; 1 2012-06-01 00:00:00    4.5 29.5 23.0   0  2.0</span></span>
<span><span class="co">#&gt; 2 2012-06-01 00:15:00    5.1 29.5 23.3   0  2.3</span></span>
<span><span class="co">#&gt; 3 2012-06-01 00:30:00    4.8 29.5 23.4   0  2.1</span></span>
<span><span class="co">#&gt; 4 2012-06-01 00:45:00    4.8 29.5 23.3   0  2.0</span></span>
<span><span class="co">#&gt; 5 2012-06-01 01:00:00    4.8 29.5 23.1   0  1.7</span></span>
<span><span class="co">#&gt; 6 2012-06-01 01:15:00    5.0 29.5 24.0   0  1.8</span></span></code></pre></div>
<p>Also note that any “dangling” observations at the start or end of the
time series that do not include an entire day are removed from the input
data prior to estimating metabolism. A warning is returned if these
observations are found and removed.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase.html">ebase</a></span><span class="op">(</span><span class="va">dat</span>, interval <span class="op">=</span> <span class="fl">900</span>, Z <span class="op">=</span> <span class="fl">1.85</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, n.chains <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt;         DateTimeStamp       Date grp    Z  DO_obs   DO_mod DO_modlo DO_modhi</span></span>
<span><span class="co">#&gt; 1 2012-06-01 00:00:00 2012-06-01   1 1.85 140.625 166.1133 166.1122 166.1143</span></span>
<span><span class="co">#&gt; 2 2012-06-01 00:15:00 2012-06-01   1 1.85 159.375 165.4136 165.1512 165.6796</span></span>
<span><span class="co">#&gt; 3 2012-06-01 00:30:00 2012-06-01   1 1.85 150.000 164.7459 164.2171 165.2783</span></span>
<span><span class="co">#&gt; 4 2012-06-01 00:45:00 2012-06-01   1 1.85 150.000 164.0582 163.2677 164.8556</span></span>
<span><span class="co">#&gt; 5 2012-06-01 01:00:00 2012-06-01   1 1.85 150.000 163.3622 162.3142 164.4218</span></span>
<span><span class="co">#&gt; 6 2012-06-01 01:15:00 2012-06-01   1 1.85 156.250 162.6401 161.3214 163.9644</span></span>
<span><span class="co">#&gt;         dDO converge       rsq         a       alo     ahi         b      blo</span></span>
<span><span class="co">#&gt; 1        NA     Fine 0.3316977        NA        NA      NA        NA       NA</span></span>
<span><span class="co">#&gt; 2 -67.17105     Fine 0.3316977 0.8937188 0.5493401 1.23722 0.3099639 0.095399</span></span>
<span><span class="co">#&gt; 3 -64.09917     Fine 0.3316977 0.8937188 0.5493401 1.23722 0.3099639 0.095399</span></span>
<span><span class="co">#&gt; 4 -66.01785     Fine 0.3316977 0.8937188 0.5493401 1.23722 0.3099639 0.095399</span></span>
<span><span class="co">#&gt; 5 -66.81056     Fine 0.3316977 0.8937188 0.5493401 1.23722 0.3099639 0.095399</span></span>
<span><span class="co">#&gt; 6 -69.32716     Fine 0.3316977 0.8937188 0.5493401 1.23722 0.3099639 0.095399</span></span>
<span><span class="co">#&gt;         bhi  P Plo Phi        R      Rlo      Rhi        D      Dlo      Dhi</span></span>
<span><span class="co">#&gt; 1        NA NA  NA  NA       NA       NA       NA       NA       NA       NA</span></span>
<span><span class="co">#&gt; 2 0.4880948  0   0   0 141.3441 91.81771 189.3398 17.07767 5.256151 26.89177</span></span>
<span><span class="co">#&gt; 3 0.4880948  0   0   0 141.3441 91.81771 189.3398 22.76065 7.016575 35.73629</span></span>
<span><span class="co">#&gt; 4 0.4880948  0   0   0 141.3441 91.81771 189.3398 19.21109 5.935086 30.23658</span></span>
<span><span class="co">#&gt; 5 0.4880948  0   0   0 141.3441 91.81771 189.3398 17.74458 5.472469 28.00020</span></span>
<span><span class="co">#&gt; 6 0.4880948  0   0   0 141.3441 91.81771 189.3398 13.08887 4.054759 20.68591</span></span></code></pre></div>
<p>The results are returned as a data frame with instantaneous metabolic
estimates for areal gross production (O2 mmol/m2/d, <code>P</code> or
<span class="math inline">\(aPAR\)</span> from above as volumetric),
respiration (O2 mmol/m2/d, <code>R</code> from above as volumetric), and
gas exchange (O2 mmol/m2/d, <code>D</code> or the remainder of the
equation from above as volumetric). Additional parameters estimated by
the model that are returned include <code>a</code> and <code>b</code> as
shown in the above equation. The <code>a</code> parameter is a constant
that represents the primary production per quantum of light with units
of (mmol/m2/d)/(W/m2) and is used to estimate gross production <span class="citation">(Grace et al. 2015)</span>. The <code>b</code>
parameter is a constant used to estimate gas exchange in (cm/hr)/(m2/s2)
(provided as 0.251 in eqn. 4 in <span class="citation">Wanninkhof
(2014)</span>).</p>
<p>A plot of the results can be made with <code><a href="../reference/ebase_plot.html">ebase_plot()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ebase_plot.html">ebase_plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-5-1.png" width="864" style="display: block; margin: auto;"></p>
<p>The daily averages can also be plotted by using
<code>instantaneous = FALSE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ebase_plot.html">ebase_plot</a></span><span class="op">(</span><span class="va">res</span>, instantaneous <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-6-1.png" width="864" style="display: block; margin: auto;"></p>
<p>Execution time of the model can also be reduced by using multiple
processors. This is done using <a href="https://cran.r-project.org/web/packages/doParallel/index.html" class="external-link">doParrallel</a>
package and registering a parallel backend as below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># setup parallel backend</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/doparallel" class="external-link">doParallel</a></span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase.html">ebase</a></span><span class="op">(</span><span class="va">dat</span>, interval <span class="op">=</span> <span class="fl">900</span>, Z <span class="op">=</span> <span class="fl">1.85</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, n.chains <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<p>Model fit can be assessed using the <code>converge</code> and
<code>rsq</code> columns from the returned results. The values in these
columns apply to each group in the <code>grp</code> column as specified
with the <code>ndays</code> argument. The <code>converge</code> column
indicates <code>"Check convergence"</code> or <code>"Fine"</code> if the
JAGS estimate converged at that iteration (repeated across rows for the
group). The <code>n.chains</code> argument can be increased if
convergence is not achieved. Similarly, the <code>rsq</code> column
shows the r-squared values of the linear fit between the modeled and
observed dissolved oxygen (repeated across rows for the group).</p>
<p>The model fit can also be assessed by comparing the observed and
modeled values for dissolved oxygen with the <code><a href="../reference/fit_plot.html">fit_plot()</a></code>
function. Estimated values are shown as line and observed values are
shown as points.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fit_plot.html">fit_plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-8-1.png" width="864" style="display: block; margin: auto;"></p>
<p>The comparison can also be separated by group with
<code>bygroup = TRUE</code> based on the value for the
<code>ndays</code> argument passed to <code><a href="../reference/ebase.html">ebase()</a></code>. The
r-squared value of the fit between modeled and observed dissolved oxygen
is also shown in the facet label for the group.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fit_plot.html">fit_plot</a></span><span class="op">(</span><span class="va">res</span>, bygroup <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>A scatterplot showing modeled versus observed dissolved oxygen can
also be returned by setting <code>scatter = TRUE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fit_plot.html">fit_plot</a></span><span class="op">(</span><span class="va">res</span>, bygroup <span class="op">=</span> <span class="cn">TRUE</span>, scatter <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The prior distributions for the <span class="math inline">\(a\)</span>, <span class="math inline">\(R\)</span>, and <span class="math inline">\(b\)</span> parameters are defined in the model
file included with the package as normal Gaussian distributions with
mean and standard deviations provided by the <code>aprior</code>,
<code>rprior</code>, and <code>bprior</code> arguments in
<code><a href="../reference/ebase.html">ebase()</a></code>. The location of the model file can be viewed as
follows.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'ebase_model.txt'</span>, package <span class="op">=</span> <span class="st">'EBASE'</span><span class="op">)</span></span></code></pre></div>
<p>The default values for the priors were chosen based on the ability of
EBASE to reproduce known parameters from a forward metabolism model. An
additional constraint is that all the prior distributions are truncated
to be positive values as required by the core metabolism equation above.
The upper limit for <span class="math inline">\(b\)</span> is also set
as twice the default value of the mean in the <code>bprior</code>
argument. Units for each parameter are (mmol/m2/d)/(W/m2) for <span class="math inline">\(a\)</span>, mmol/m2/d for <span class="math inline">\(R\)</span>, and (cm/hr)/(m2/s2) for <span class="math inline">\(b\)</span>.</p>
<p>The prior distributions can be viewed with the
<code><a href="../reference/prior_plot.html">prior_plot()</a></code> function. No changes are needed to the default
arguments for this function if the default arguments are used for
<code><a href="../reference/ebase.html">ebase()</a></code>. The density curves are normalized such that the
peak value is always equal to 1.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prior_plot.html">prior_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-12-1.png" width="864" style="display: block; margin: auto;"></p>
<p>95% credible intervals for <code>a</code>, <code>R</code> (as areal),
and <code>b</code> are also returned with the output from
<code><a href="../reference/ebase.html">ebase()</a></code> in the corresponding columns <code>alo</code>,
<code>ahi</code>, <code>blo</code>, <code>bhi</code>, <code>Rlo</code>,
and <code>Rhi</code>, for the 2.5th and 97.5th percentile estimates for
each parameter, respectively. These values indicate the interval within
which there is a 95% probability that the true parameter is in this
range and is a representation of the posterior distributions for each
parameter. Note that all values for these parameters are repeated across
rows, although only one estimate for each is returned based on the
number of days defined by <code>ndays</code>.</p>
<p>The credible intervals can be plotted with the
<code><a href="../reference/credible_plot.html">credible_plot()</a></code> function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/credible_plot.html">credible_plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The credible intervals can also be retrieved as a data frame using
<code><a href="../reference/credible_prep.html">credible_prep()</a></code>. This function is provided as a convenience
to parse the results from <code><a href="../reference/ebase.html">ebase()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/credible_prep.html">credible_prep</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   grp [4]</span></span></span>
<span><span class="co">#&gt;    Date         grp var      mean       lo      hi</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2012-06-01     1 a       0.894   0.549    1.24 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2012-06-01     1 R     141.     91.8    189.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2012-06-01     1 b       0.310   0.095<span style="text-decoration: underline;">4</span>   0.488</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2012-06-02     2 a       0.929   0.705    1.18 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2012-06-02     2 R     180.    133.     229.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2012-06-02     2 b       0.307   0.092<span style="text-decoration: underline;">7</span>   0.484</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2012-06-03     3 a       0.617   0.410    0.833</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2012-06-03     3 R     130.     98.5    161.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2012-06-03     3 b       0.321   0.113    0.490</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2012-06-04     4 a       0.728   0.513    0.951</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 2012-06-04     4 R     140.    107.     171.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 2012-06-04     4 b       0.280   0.077<span style="text-decoration: underline;">2</span>   0.473</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="changing-the-default-arguments">Changing the default arguments<a class="anchor" aria-label="anchor" href="#changing-the-default-arguments"></a>
</h3>
<div class="section level4">
<h4 id="equation-optimization-length">Equation optimization length<a class="anchor" aria-label="anchor" href="#equation-optimization-length"></a>
</h4>
<p>The <code>ndays</code> argument in <code><a href="../reference/ebase.html">ebase()</a></code> defines the
model optimization period as the number of days that are used for
optimizing the above mass balance equation. By default, this is done
each day, i.e., <code>ndays = 1</code> such that a loop is used that
applies the model equation to observations within each day, evaluated
iteratively from the first observation in a day to the last. Individual
parameter estimates for <code>a</code>, <code>R</code>, and
<code>b</code> are then returned for each day. However, more days can be
used to estimate the unknown parameters, such that the loop can be
evaluated for every <code>ndays</code> specified by the argument. The
<code>ndays</code> argument will separate the input data into groups of
consecutive days, where each group has a total number of days equal to
<code>ndays</code>. The final block may not include the complete number
of days specified by <code>ndays</code> if the number of unique dates in
the input data includes a remainder when divided by <code>ndays</code>,
e.g., if seven days are in the input data and <code>ndays = 5</code>,
there will be two groups where the first has five days and the second
has two days. The output data from <code>ebase</code> includes a column
that specifies the grouping that was used based on
<code>ndays</code>.</p>
<p>Here, the number of days used to optimize the equation is set to all
days in the input data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase.html">ebase</a></span><span class="op">(</span><span class="va">dat</span>, interval <span class="op">=</span> <span class="fl">900</span>, Z <span class="op">=</span> <span class="fl">1.85</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, n.chains <span class="op">=</span> <span class="fl">2</span>, ndays <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<p>And the resulting plot:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ebase_plot.html">ebase_plot</a></span><span class="op">(</span><span class="va">res</span>, instantaneous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-16-1.png" width="864" style="display: block; margin: auto;"></p>
<p>And the fit of observed and modeled dissolved oxygen (note the
unbroken line for all days estimated together):</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fit_plot.html">fit_plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-17-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="starting-value">Starting value<a class="anchor" aria-label="anchor" href="#starting-value"></a>
</h4>
<p>The <code>doave</code> argument can be used to define which dissolved
oxygen value is used as the starting point in the Bayesian estimation
for the optimization period. The default setting
(<code>doave = TRUE</code>) will use the average of all the dissolved
oxygen values in the optimization period defined by <code>ndays</code>.
For example, the average of all dissolved oxygen values in each 24 hour
period will be used if <code>doave = TRUE</code> and
<code>ndays = 1</code>. The first dissolved oxygen observation of the
time series in the optimization period will be used as the starting
point if <code>doave = F</code>. In this case, the simulated dissolved
oxygen time series will always start at the first observed dissolved
oxygen value for each optimization period.</p>
<p>The default setting uses the average observed dissolved oxygen in
each optimization period as the starting value. Below,
<code>doave = FALSE</code> is used to set the first observed dissolved
oxygen as the starting value.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase.html">ebase</a></span><span class="op">(</span><span class="va">dat</span>, interval <span class="op">=</span> <span class="fl">900</span>, Z <span class="op">=</span> <span class="fl">1.85</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, n.chains <span class="op">=</span> <span class="fl">2</span>, ndays <span class="op">=</span> <span class="fl">1</span>, doave <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fit_plot.html">fit_plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-19-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="missing-values">Missing values<a class="anchor" aria-label="anchor" href="#missing-values"></a>
</h4>
<p>Missing values in the input data for the specified time step in the
<code>interval</code> argument to <code><a href="../reference/ebase.html">ebase()</a></code> must be
interpolated prior to estimating metabolism. It is the responsibility of
the user to verify that these interpolated values are not wildly
inaccurate. Missing values are linearly interpolated between non-missing
values at the time step specified by the value in <code>interval</code>.
This works well for small gaps, but can easily create inaccurate values
at gaps larger than a few hours.</p>
<p>As an example, the <code>dat</code> object above is subset to 90% of
its observations.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">222</span><span class="op">)</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">DateTimeStamp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span>
<span><span class="co">#&gt;         DateTimeStamp DO_obs Temp  Sal PAR WSpd</span></span>
<span><span class="co">#&gt; 1 2012-06-01 00:00:00    4.5 29.5 23.0   0  2.0</span></span>
<span><span class="co">#&gt; 2 2012-06-01 00:30:00    4.8 29.5 23.4   0  2.1</span></span>
<span><span class="co">#&gt; 3 2012-06-01 01:00:00    4.8 29.5 23.1   0  1.7</span></span>
<span><span class="co">#&gt; 4 2012-06-01 01:30:00    5.4 29.6 24.9   0  1.8</span></span>
<span><span class="co">#&gt; 5 2012-06-01 01:45:00    5.4 29.6 24.6   0  1.8</span></span>
<span><span class="co">#&gt; 6 2012-06-01 02:00:00    5.3 29.6 24.8   0  2.0</span></span></code></pre></div>
<p>The <code><a href="../reference/ebase_prep.html">ebase_prep()</a></code> function is used internally to
<code>ebase</code> to prepare the data for the metabolism calculations.
This function interpolates the missing data and returns a column
<code>isinterp</code> that specifies <code>TRUE</code> or
<code>FALSE</code> if a value is interpolated.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat2interp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase_prep.html">ebase_prep</a></span><span class="op">(</span><span class="va">dat2</span>, Z <span class="op">=</span> <span class="fl">1.85</span>, interval <span class="op">=</span> <span class="fl">900</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat2interp</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Date       DateTimeStamp isinterp   DO_obs   DO_sat    Z Temp  Sal PAR</span></span>
<span><span class="co">#&gt; 1 2012-06-02 2012-06-02 00:00:00    FALSE 323.7500 394.9605 1.85 28.8 21.8   0</span></span>
<span><span class="co">#&gt; 2 2012-06-02 2012-06-02 00:15:00    FALSE 329.5313 393.4299 1.85 28.8 22.5   0</span></span>
<span><span class="co">#&gt; 3 2012-06-02 2012-06-02 00:30:00    FALSE 323.7500 391.6884 1.85 28.9 23.0   0</span></span>
<span><span class="co">#&gt; 4 2012-06-02 2012-06-02 00:45:00    FALSE 323.7500 392.7755 1.85 28.9 22.5   0</span></span>
<span><span class="co">#&gt; 5 2012-06-02 2012-06-02 01:00:00    FALSE 312.1875 392.5577 1.85 29.0 22.3   0</span></span>
<span><span class="co">#&gt; 6 2012-06-02 2012-06-02 01:15:00    FALSE 300.6250 391.6888 1.85 29.0 22.7   0</span></span>
<span><span class="co">#&gt;   WSpd       sc grp</span></span>
<span><span class="co">#&gt; 1  1.9 355.5996   1</span></span>
<span><span class="co">#&gt; 2  1.8 356.3840   1</span></span>
<span><span class="co">#&gt; 3  1.9 355.2102   1</span></span>
<span><span class="co">#&gt; 4  1.9 354.6523   1</span></span>
<span><span class="co">#&gt; 5  1.8 352.7068   1</span></span>
<span><span class="co">#&gt; 6  1.8 353.1511   1</span></span></code></pre></div>
<p>The interpolated values can be visually inspected using the
<code><a href="../reference/interp_plot.html">interp_plot()</a></code> function.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/interp_plot.html">interp_plot</a></span><span class="op">(</span><span class="va">dat2</span>, Z <span class="op">=</span> <span class="fl">1.85</span>, interval <span class="op">=</span> <span class="fl">900</span>, param <span class="op">=</span> <span class="st">'DO_sat'</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-22-1.png" width="864" style="display: block; margin: auto;"></p>
<p>The <code><a href="../reference/ebase.html">ebase()</a></code> function includes the <code>maxinterp</code>
argument to assign <code>NA</code> values to continuously interpolated
rows with length greater than the value defined by
<code>maxinterp</code>. This value is set to 12 hours by default and
applies to the groupings defined by <code>ndays</code>, i.e., any group
with a continuous set of interpolated values where the time is greater
than 12 hours are assigned <code>NA</code> (except <code>Date</code> and
<code>DateTimeStamp</code>). The numeric value passed to
<code>maxinterp</code> is the number of time steps for the input data,
e.g., 48 would be 12 hours if the time step is 900 seconds.</p>
</div>
<div class="section level4">
<h4 id="changing-priors">Changing priors<a class="anchor" aria-label="anchor" href="#changing-priors"></a>
</h4>
<p>If the default values prior distributions are changed for
<code><a href="../reference/ebase.html">ebase()</a></code>, the <code><a href="../reference/prior_plot.html">prior_plot()</a></code> function can be used
to assess how changing characteristics of the prior distributions could
influence the resulting parameter estimates and their posterior
distributions (e.g., as shown with <code><a href="../reference/credible_plot.html">credible_plot()</a></code>).</p>
<p>Here, the prior distribution for the <span class="math inline">\(b\)</span> parameter is changed to have a mean of
0.4 and standard deviation of 1.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prior_plot.html">prior_plot</a></span><span class="op">(</span>bprior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-23-1.png" width="864" style="display: block; margin: auto;"></p>
<p>The same change to the prior distribution for the <span class="math inline">\(b\)</span> parameter is applied to
<code><a href="../reference/ebase.html">ebase()</a></code></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebase.html">ebase</a></span><span class="op">(</span><span class="va">dat</span>, interval <span class="op">=</span> <span class="fl">900</span>, Z <span class="op">=</span> <span class="fl">1.85</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, n.chains <span class="op">=</span> <span class="fl">2</span>, bprior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ebase_plot.html">ebase_plot</a></span><span class="op">(</span><span class="va">res</span>, instantaneous <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-24-1.png" width="864" style="display: block; margin: auto;"></p>
<p>The <code><a href="../reference/credible_plot.html">credible_plot()</a></code> function can be used to assess how
changing the prior distributions has an influence on the posterior
distributions of the parameters.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/credible_plot.html">credible_plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="EBASE_files/figure-html/unnamed-chunk-25-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Grace15" class="csl-entry">
Grace, Michael R, Darren P Giling, Sally Hladyz, Valerie Caron, Ross M
Thompson, and Ralph Mac Nally. 2015. <span>“Fast Processing of Diel
Oxygen Curves: Estimating Stream Metabolism with BASE (BA Yesian s
Ingle-Station e Stimation).”</span> <em>Limnology and Oceanography:
Methods</em> 13 (3): 103–14. <a href="https://doi.org/10.1002/lom3.10011" class="external-link">https://doi.org/10.1002/lom3.10011</a>.
</div>
<div id="ref-Wanninkhof14" class="csl-entry">
Wanninkhof, Rik. 2014. <span>“Relationship Between Wind Speed and Gas
Exchange over the Ocean Revisited.”</span> <em>Limnology and
Oceanography: Methods</em> 12 (6): 351–62. <a href="https://doi.org/10.4319/lom.2014.12.351" class="external-link">https://doi.org/10.4319/lom.2014.12.351</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Marcus Beck, Maria Herrmann, Jill Arriola, Raymond Najjar, Wade McGillis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
